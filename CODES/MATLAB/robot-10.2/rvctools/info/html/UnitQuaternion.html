<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="http://www.petercorke.com/RVC/common/toolboxhelp.css">
    <title>M-File Help: UnitQuaternion</title>
  </head>
  <body>
  <table border="0" cellspacing="0" width="100%">
    <tr class="subheader">
      <td class="headertitle">M-File Help: UnitQuaternion</td>
      <td class="subheader-left"><a href="matlab:open UnitQuaternion">View code for UnitQuaternion</a></td>
    </tr>
  </table>
<h1>UnitQuaternion</h1><p><span class="helptopic">Unit quaternion class</span></p><p>
A UnitQuaternion is a compact method of representing a 3D rotation that has
computational advantages including speed and numerical robustness.
A quaternion has 2 parts, a scalar s, and a vector v and is typically
written: q = s &amp;lt;vx, vy, vz&amp;gt;.

</p>
<p>
A UnitQuaternion is one for which s&circ;2+vx&circ;2+vy&circ;2+vz&circ;2 = 1.  It can be
considered as a rotation by an angle theta about a unit-vector V in space where

</p>
<pre style="width: 90%%;" class="examples">
q&nbsp;=&nbsp;cos&nbsp;(theta/2)&nbsp;<&nbsp;v&nbsp;sin(theta/2)>
</pre>
<h2>Constructors</h2>
<table class="list">
  <tr><td style="white-space: nowrap;" class="col1"> UnitQuaternion</td> <td>general constructor</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> UnitQuaternion.eul</td> <td>constructor, from Euler angles</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> UnitQuaternion.rpy</td> <td>constructor, from roll-pitch-yaw angles</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> UnitQuaternion.angvec</td> <td>constructor, from (angle and vector)</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> UnitQuaternion.omega</td> <td>constructor for angle*vector</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> UnitQuaternion.Rx</td> <td>constructor, from x-axis rotation</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> UnitQuaternion.Ry</td> <td>constructor, from y-axis rotation</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> UnitQuaternion.Rz</td> <td>constructor, from z-axis rotation</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> UnitQuaternion.vec</td> <td>constructor, from 3-vector</td></tr>
</table>
<h2>Display methods</h2>
<table class="list">
  <tr><td style="white-space: nowrap;" class="col1"> display</td> <td>print in human readable form</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> plot</td> <td>plot a coordinate frame representing orientation of quaternion</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> animate</td> <td>animates a coordinate frame representing changing orientation
of quaternion sequence</td></tr>
</table>
<h2>Operation methods</h2>
<table class="list">
  <tr><td style="white-space: nowrap;" class="col1"> inv</td> <td>inverse</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> conj</td> <td>conjugate</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> unit</td> <td>unitized quaternion</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> dot</td> <td>derivative of quaternion with angular velocity</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> norm</td> <td>norm, or length</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> inner</td> <td>inner product</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> angle</td> <td>angle between two quaternions</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> interp</td> <td>interpolation (slerp) between two quaternions</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> UnitQuaternion.qvmul</td> <td>multiply unit-quaternions in 3-vector form</td></tr>
</table>
<h2>Conversion methods</h2>
<table class="list">
  <tr><td style="white-space: nowrap;" class="col1"> char</td> <td>convert to string</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> double</td> <td>convert to 4-vector</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> matrix</td> <td>convert to 4x4 matrix</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> tovec</td> <td>convert to 3-vector</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> R </td> <td>convert to 3x3 rotation matrix</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> T </td> <td>convert to 4x4 homogeneous transform matrix</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> toeul</td> <td>convert to Euler angles</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> torpy</td> <td>convert to roll-pitch-yaw angles</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> toangvec</td> <td>convert to angle vector form</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> SO3</td> <td>convert to SO3 class</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> SE3</td> <td>convert to SE3 class</td></tr>
</table>
<h2>Overloaded operators</h2>
<table class="list">
  <tr><td style="white-space: nowrap;" class="col1"> q*q2</td> <td>quaternion (Hamilton) product</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> q.*q2</td> <td>quaternion (Hamilton) product followed by unitization</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> q*s</td> <td>quaternion times scalar</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> q/q2</td> <td>q*q2.inv</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> q./q2</td> <td>q*q2.inv followed by unitization</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> q/s</td> <td>quaternion divided by scalar</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> q^n</td> <td>q to power n (integer only)</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> q+q2</td> <td>elementwise sum of quaternion elements (result is a Quaternion)</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> q-q2</td> <td>elementwise difference of quaternion elements (result is a Quaternion)</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> q1==q2</td> <td>test for quaternion equality</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> q1~=q2</td> <td>test for quaternion inequality</td></tr>
</table>
<h2>Properties (read only)</h2>
<table class="list">
  <tr><td style="white-space: nowrap;" class="col1"> s </td> <td>real part</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> v </td> <td>vector part</td></tr>
</table>
<h2>Notes</h2>
<ul>
  <li>Many methods and operators are inherited from the Quaternion superclass.</li>
  <li>UnitQuaternion objects can be used in vectors and arrays.</li>
  <li>A subclass of Quaternion</li>
  <li>The + and - operators return a Quaternion object not a UnitQuaternion</li>
</ul>
<p>
since the result is not, in general, a valid UnitQuaternion.

</p>
<ul>
  <li>For display purposes a Quaternion differs from a UnitQuaternion by
using << >> notation rather than < >.</li>
  <li>To a large extent polymorphic with the SO3 class.</li>
</ul>
<h2>References</h2>
<ul>
  <li>Animating rotation with quaternion curves,
K. Shoemake,
in Proceedings of ACM SIGGRAPH, (San Fran cisco), pp. 245-254, 1985.</li>
  <li>On homogeneous transforms, quaternions, and computational efficiency,
J. Funda, R. Taylor, and R. Paul,
IEEE Transactions on Robotics and Automation, vol. 6, pp. 382-388, June 1990.</li>
  <li>Robotics, Vision & Control,
P. Corke, Springer 2011.</li>
</ul>
<h2>See also</h2>
<p>
<a href="Quaternion.html">Quaternion</a>, <a href="SO3.html">SO3</a></p>
<hr>
<a name="UnitQuaternion"><h1>UnitQuaternion.UnitQuaternion</h1></a>
<p><span class="helptopic">Create a unit quaternion object</span></p><p>
Construct a <span style="color:red">UnitQuaternion</span> from various other orientation representations.

</p>
<p>
<strong>q</strong> = <span style="color:red">UnitQuaternion</span>() is the identitity <span style="color:red">UnitQuaternion</span> 1&amp;lt;0,0,0&amp;gt; representing a null rotation.

</p>
<p>
<strong>q</strong> = <span style="color:red">UnitQuaternion</span>(<strong>q1</strong>) is a copy of the <span style="color:red">UnitQuaternion</span> <strong>q1</strong>, if <strong>q1</strong> is a
Quaternion it is normalised.

</p>
<p>
<strong>q</strong> = <span style="color:red">UnitQuaternion</span>(<strong>s</strong>, <strong>v</strong>) is a unit quaternion formed by specifying directly
its scalar and vector parts which are normalised.

</p>
<p>
<strong>q</strong> = <span style="color:red">UnitQuaternion</span>([<strong>s</strong> V1 V2 V3]) is a quaternion formed by specifying
directly its 4 elements which are normalised.

</p>
<p>
<strong>q</strong> = <span style="color:red">Quaternion</span>(<strong>R</strong>) is a <span style="color:red">UnitQuaternion</span> corresponding to the SO(3)
orthonormal rotation matrix <strong>R</strong> (3x3).  If <strong>R</strong> (3x3xN) is a sequence then <strong>q</strong>
(Nx1) is a vector of Quaternions corresponding to the elements of <strong>R</strong>.

</p>
<p>
<strong>q</strong> = <span style="color:red">Quaternion</span>(<strong>T</strong>) is a <span style="color:red">UnitQuaternion</span> equivalent to the rotational part
of the SE(3) homogeneous transform <strong>T</strong> (4x4). If <strong>T</strong> (4x4xN) is a sequence
then <strong>q</strong> (Nx1) is a vector of Quaternions corresponding to the elements of
<strong>T</strong>.

</p>
<h2>Notes</h2>
<ul>
  <li>Only the R and T forms are vectorised.</li>
</ul>
<p>
See also <span style="color:red">UnitQuaternion</span>.eul, <span style="color:red">UnitQuaternion</span>.rpy, <span style="color:red">UnitQuaternion</span>.angvec,
<span style="color:red">UnitQuaternion</span>.omega, <span style="color:red">UnitQuaternion</span>.Rx, <span style="color:red">UnitQuaternion</span>.Ry,
<span style="color:red">UnitQuaternion</span>.Rz.

</p>
<hr>
<a name="angle"><h1>UnitQuaternion.angle</h1></a>
<p><span class="helptopic">Angle between two UnitQuaternions</span></p><p>
Q1.<span style="color:red">theta</span>(<strong>q2</strong>) is the angle (in radians) between two UnitQuaternions Q1 and <strong>q2</strong>.

</p>
<h2>Notes</h2>
<ul>
  <li>Either or both Q1 and Q2 can be a vector.</li>
</ul>
<h2>References</h2>
<ul>
  <li>Metrics for 3D rotations: comparison and analysis
Du Q. Huynh
J.Math Imaging Vis. DOFI 10.1007/s10851-009-0161-2</li>
</ul>
<h2>See also</h2>
<p>
<a href="Quaternion.angvec.html">Quaternion.angvec</a></p>
<hr>
<a name="angvec"><h1>UnitQuaternion.angvec</h1></a>
<p><span class="helptopic">Construct from angle and rotation vector</span></p><p>
<strong>q</strong> = <span style="color:red">UnitQuaternion</span>.<span style="color:red">angvec</span>(<strong>th</strong>, <strong>v</strong>) is a <span style="color:red">UnitQuaternion</span> representing rotation of <strong>th</strong> about the vector <strong>v</strong> (3x1).

</p>
<h2>See also</h2>
<p>
<a href="UnitQuaternion.omega.html">UnitQuaternion.omega</a></p>
<hr>
<a name="animate"><h1>UnitQuaternion.animate</h1></a>
<p><span class="helptopic">Animate a quaternion object</span></p><p>
Q.<span style="color:red">animate</span>(<strong>options</strong>) animates a quaternion array Q as a 3D coordinate frame.

</p>
<p>
Q.<span style="color:red">animate</span>(<strong>qf</strong>, <strong>options</strong>) animates a 3D coordinate frame moving from
orientation Q to orientation <strong>qf</strong>.

</p>
<h2>Options</h2>
<p>
Options are passed to tranimate and include:

</p>
<table class="list">
  <tr><td style="white-space: nowrap;" class="col1">'fps',  fps</td> <td>Number of frames per second to display (default 10)</td></tr>
  <tr><td style="white-space: nowrap;" class="col1">'nsteps',  n</td> <td>The number of steps along the path (default 50)</td></tr>
  <tr><td style="white-space: nowrap;" class="col1">'axis', A</td> <td>Axis bounds [xmin, xmax, ymin, ymax, zmin, zmax]</td></tr>
  <tr><td style="white-space: nowrap;" class="col1">'movie', M</td> <td>Save frames as files in the folder M</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> 'cleanup'</td> <td>Remove the frame at end of animation</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> 'noxyz'</td> <td>Don't label the axes</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> 'rgb'</td> <td>Color the axes in the order x=red, y=green, z=blue</td></tr>
  <tr><td style="white-space: nowrap;" class="col1"> 'retain'</td> <td>Retain frames, don't animate</td></tr>
</table>
<p>
Additional <strong>options</strong> are passed through to TRPLOT.

</p>
<h2>See also</h2>
<p>
<a href="tranimate.html">tranimate</a>, <a href="trplot.html">trplot</a></p>
<hr>
<a name="char"><h1>UnitQuaternion.char</h1></a>
<p><span class="helptopic">Convert to string</span></p><p>
<strong>s</strong> = Q.<span style="color:red">char</span>() is a compact string representation of the quaternion's value
as a 4-tuple.  If Q is a vector then <strong>s</strong> has one line per element.

</p>
<h2>See also</h2>
<p>
<a href="Quaternion.char.html">Quaternion.char</a></p>
<hr>
<a name="dot"><h1>UnitQuaternion.dot</h1></a>
<p><span class="helptopic">Quaternion derivative</span></p><p>
<strong>qd</strong> = Q.<span style="color:red">dot</span>(<strong>omega</strong>) is the rate of change in the world frame of a body
frame with attitude Q and angular velocity OMEGA (1x3) expressed as a
quaternion.

</p>
<h2>Notes</h2>
<ul>
  <li>This is not a group operator, but it is useful to have the result as a
quaternion.</li>
</ul>
<h2>Reference</h2>
<ul>
  <li>Robotics, Vision & Control, 2nd edition, Peter Corke, Chap 3.</li>
</ul>
<h2>See also</h2>
<p>
<a href="UnitQuaternion.dotb.html">UnitQuaternion.dotb</a></p>
<hr>
<a name="dotb"><h1>UnitQuaternion.dotb</h1></a>
<p><span class="helptopic">Quaternion derivative</span></p><p>
<strong>qd</strong> = Q.<span style="color:red">dot</span>(<strong>omega</strong>) is the rate of change in the body frame of a body frame
with attitude Q and angular velocity OMEGA (1x3) expressed as a
quaternion.

</p>
<h2>Notes</h2>
<ul>
  <li>This is not a group operator, but it is useful to have the result as a
quaternion.</li>
</ul>
<h2>Reference</h2>
<ul>
  <li>Robotics, Vision & Control, 2nd edition, Peter Corke, Chap 3.</li>
</ul>
<h2>See also</h2>
<p>
<a href="UnitQuaternion.dot.html">UnitQuaternion.dot</a></p>
<hr>
<a name="eul"><h1>UnitQuaternion.eul</h1></a>
<p><span class="helptopic">Construct from Euler angles</span></p><p>
<strong>q</strong> = <span style="color:red">UnitQuaternion</span>.<span style="color:red">eul</span>(<strong>phi</strong>, <strong>theta</strong>, <strong>psi</strong>, <strong>options</strong>) is a <span style="color:red">UnitQuaternion</span>
representing rotation equivalent to the specified Euler angles
angles. These correspond to rotations about the Z, Y, Z axes
respectively.

</p>
<p>
<strong>q</strong> = <span style="color:red">UnitQuaternion</span>.<span style="color:red">eul</span>(<strong>eul</strong>, <strong>options</strong>) as above but the Euler angles are
taken from the vector (1x3) <strong>eul</strong> = [<strong>phi</strong> <strong>theta</strong> <strong>psi</strong>]. If <strong>eul</strong> is a matrix
(Nx3) then <strong>q</strong> is a vector (1xN) of <span style="color:red">UnitQuaternion</span> objects where the index
corresponds to rows of <strong>eul</strong> which are assumed to be [<strong>phi</strong>,<strong>theta</strong>,<strong>psi</strong>].

</p>
<h2>Options</h2>
<table class="list">
  <tr><td style="white-space: nowrap;" class="col1"> 'deg'</td> <td>Compute angles in degrees (radians default)</td></tr>
</table>
<h2>Notes</h2>
<ul>
  <li>Is vectorised, see eul2r for details.</li>
</ul>
<h2>See also</h2>
<p>
<a href="UnitQuaternion.rpy.html">UnitQuaternion.rpy</a>, <a href="eul2r.html">eul2r</a></p>
<hr>
<a name="increment"><h1>UnitQuaternion.increment</h1></a>
<p><span class="helptopic">Update quaternion by angular displacement</span></p><p>
<strong>qu</strong> = Q.<span style="color:red">increment</span>(<strong>omega</strong>) updates Q by a rotation which is given as a spatial
displacement <strong>omega</strong> (3x1) whose direction is the rotation axis and
magnitude is the amount of rotation.

</p>
<h2>See also</h2>
<p>
<a href="tr2delta.html">tr2delta</a></p>
<hr>
<a name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         