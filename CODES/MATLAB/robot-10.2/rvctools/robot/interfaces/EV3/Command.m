% EV3 command construction
%
% Methods::
% Command                   Constructor, creates an empty command object
% delete                    Destructor, clears the command object
%
% addHeaderSystem           Add a system header to the command object
% addHeaderSystemReply      Add a system header with reply to the command object
% addHeaderDirect           Add a direct header to the command object
% addHeaderDirectReply      Add a direct header with reply to the command object
% addLength                 Add the length of the msg to the front of the command object
% addSystemCommand          Add a system command to the command object
% addDirectCommand          Add a direct command to the command object
%
% clear                     Clear the command msg
% display                   Display the command msg (decimal)
% displayHex                Display thed command msg (hex)
%
% LC0                       Add a local constant 0 to the command object
% LC1                       Add a local constant 1 to the command object
% LC2                       Add a local constant 2 to the command object
% LC4                       Add a local constant 4 to the command object
% LV0                       Add a local variable 0 to the command object
% GV0                       Add a global variable 0 to the command object
% LCS                       Add a local constant string to the command object
%
% addValue                  Add a numerical value to the command object
% addArray                  Add a numerical array to the command object
% addString                 Add a string to the command object
% addLCSString              Add a LCS string to the command object
%
% LONGToBytes               Add a LONGToBytes to the command object
% WORDToBytes               Add a WORDToBytes to the command object
% BYTEToBytes               Add a BYTEToBytes to the command object
%
% PROGRAMHeader             Add a PROGRAMHeader to the command object
% addFileSize               Add the filesize to the command object
% VMTHREADHeader            Add a VMTHREADHeader to the command object
% SUBCALLHeader             Add a SUBCALLHeader to the command object
% BLOCKHeader               Add a BLOCKHeader to the command object
% GenerateByteCode          Print the command message to a file
%
% opNOP                     Add a opNOP opcode to the command object
% opOBJECT_END              Add a opOBJECT_END opcode to the command object
%
% opJR                      Add a opJR opcode to the command object
%
% opUI_FLUSH                Add a opUI_FLUSH opcode to the command object
%
% opUI_READ_GET_VBATT       Add a opUI_READ opcode with a GET_VBATT subcode to the command object
% opUI_READ_GET_LBATT       Add a opUI_READ opcode with a GET_LBATT subcode to the command object
%
% opUI_WRITE_PUT_STRING     Add a opUI_WRITE opcode with a PUT_STRING subcode to the command object
% opUI_WRITE_INIT_RUN       Add a opUI_WRITE opcode with a INIT_RUN subcode to the command object
% opUI_WRITE_LED            Add a opUI_WRITE opcode with a LED subcode to the command object
%
% opUI_DRAW_UPDATE          Add a opUI_DRAW opcode with a UPDATE subcode to the command object
% opUI_DRAW_CLEAN           Add a opUI_DRAW opcode with a CLEAN subcode to the command object
% opUI_DRAW_PIXEL           Add a opUI_DRAW opcode with a PIXEL subcode to the command object
% opUI_DRAW_LINE            Add a opUI_DRAW opcode with a LINE subcode to the command object
% opUI_DRAW_CIRCLE          Add a opUI_DRAW opcode with a CIRCLE subcode to the command object
% opUI_DRAW_TEXT            Add a opUI_DRAW opcode with a TEXT subcode to the command object
% opUI_DRAW_VALUE           Add a opUI_DRAW opcode with a VALUE subcode to the command object
% opUI_DRAW_FILLRECT        Add a opUI_DRAW opcode with a FILLRECT subcode to the command object
% opUI_DRAW_RECT            Add a opUI_DRAW opcode with a RECT subcode to the command object
% opUI_DRAW_INVERSERECT     Add a opUI_DRAW opcode with a INVERSERECT subcode to the command object
% opUI_DRAW_SELECT_FONT     Add a opUI_DRAW opcode with a SELECT_FONT subcode to the command object
% opUI_DRAW_TOPLINE         Add a opUI_DRAW opcode with a TOPLINE subcode to the command object
% opUI_DRAW_FILLWINDOW      Add a opUI_DRAW opcode with a FILLWINDOW subcode to the command object
% opUI_DRAW_FILLCIRCLE      Add a opUI_DRAW opcode with a FILLCIRCLE subcode to the command object
% opUI_DRAW_STORE           Add a opUI_DRAW opcode with a STORE subcode to the command object
% opUI_DRAW_RESTORE         Add a opUI_DRAW opcode with a RESTORE subcode to the command object
%
% opTIMER_WAIT              Add a opTIMER opcode with a WAIT subcode to the command object
% opTIMER_READY             Add a opTIMER opcode with a READY subcode to the command object
% opTIMER_READ              Add a opTIMER opcode with a READ subcode to the command object
%
% opSOUND_BREAK             Add a opSOUND opcode with a BREAK subcode to the command object
% opSOUND_TONE              Add a opSOUND opcode with a TONE subcode to the command object
% opSOUND_PLAY              Add a opSOUND opcode with a PLAY subcode to the command object
% opSOUND_REPEAT            Add a opSOUND opcode with a REPEAT subcode to the command object
% opSOUND_TEST              Add a opSOUND opcode with a TEST subcode to the command object
% opSOUND_READY             Add a opSOUND opcode with a READY subcode to the command object
%
% opINPUT_DEVICE_LIST       Add a opINPUT opcode with a DEVICE_LIST subcode to the command object
%
% opINPUT_DEVICE_GET_TYPEMODE Add a INPUT_DEVICE opcode with a GET_TYPEMODE subcode to the command object
% opINPUT_DEVICE_GET_SYMBOL Add a INPUT_DEVICE opcode with a GET_SYMBOL subcode to the command object
% opINPUT_DEVICE_CLR_ALL    Add a INPUT_DEVICE opcide with a CLR_ALL subcode to the command object
% opINPUT_DEVICE_GET_NAME   Add a INPUT_DEVICE opcode with a GET_NAME subcode to the command object.
%
% opINPUT_READ              Add a opINPUT_READ opcode to the command object
% opINPUT_READY             Add a opINPUT_READY opcode to the command object
% opINPUT_READSI            Add a opINPUT_READSI opcode to the command object
%
% opOUTPUT_SET_TYPE         Add a opOUTPUT_SET_TYPE opcode to the command object
% opOUTPUT_RESET            Add a opOUTPUT_RESET opcode to the command object
% opOUTPUT_STOP             Add a opOUTPUT_STOP opcode to the command object
% opOUTPUT_SPEED            Add a opOUTPUT_SPEED opcode to the command object
% opOUTPUT_POWER            Add a opOUTPUT_POWER opcode to the command object
% opOUTPUT_START            Add a opOUTPUT_START opcode to the command object
% opOUTPUT_POLARITY         Add a opOUTPUT_POLARITY opcode to the command object
% opOUTPUT_READ             Add a opOUTPUT_READ opcode to the command object
% opOUTPUT_TEST             Add a opOUTPUT_TEST opcode to the command object
% opOUTPUT_READY            Add a opOUTPUT_READY opcode to the command object
% opOUTPUT_STEP_POWER       Add a opOUTPUT_STEP_POWER opcode to the command object
% opOUTPUT_STEP_SPEED       Add a opOUTPUT_STEP_SPEED opcode to the command object
% opOUTPUT_TIME_SPEED       Add a opOUTPUT_TIME_SPEED opcode to the command object
% opOUTPUT_STEP_SYNC        Add a opOUTPUT_STEP_SYNC opcode to the command object
% opOUTPUT_TIME_SYNC        Add a opOUTPUT_TIME_SYNC opcode to the command object
% opOUTPUT_CLR_COUNT        Add a opOUTPUT_CLR_COUNT opcode to the command object
% opOUTPUT_GET_COUNT        Add a opOUTPUT_GET_COUNT opcode to the command object
%
% opCOMGET_SET_BRICKNAME    Add a opCOMGET opcode with a GET_BRICKNAME subcode to the command object
% opCOMSET_SET_BRICKNAME    Add a opCOMSET opcode with a SET_BRICKNAME subcode to the command object
%
% opMAILBOX_WRITE           Add a opMAILBOX_WRITE opcode to the command object
%
% BEGIN_DOWNLOAD            Add a BEGIN_DOWNLOAD system command to the command object
% CONTINUE_DOWNLOAD         Add a CONTINUE_DOWNLOAD system command to the command object
% BEGIN_UPLOAD              Add a BEGIN_UPLOAD system command to the command object
% CONTINUE_UPLOAD           Add a CONTINUE_UPLOAD system command to the command object
% LIST_FILES                Add a LIST_FILES system command to the command object
% CONTINUE_LIST_FILES       Add a CONTINUE_LIST_FILES system command to the command object
% CREATE_DIR                Add a CREATE_DIR system command to the command object
% DELETE_FILE               Add a DELETE_FILE system command to the command object
% WRITEMAILBOX              Add a WRITEMAILBOX system command to the command object
% 
% Notes::
% - Refer to the EV3 documentation or source code for a more detailed
% description of the commands.
%
% Example::
%                   cmd = Command();
%                   cmd.addHeaderDirect(42,0,0);
%                   cmd.opSOUND_TONE(volume,frequency,duration);
%                   cmd.addLength();

classdef Command < handle

    % Communications format (c_com.h):
    % /*
    %       System Command Bytes:
    %   ,------,------,------,------,------,------,------,------,
    %   |Byte 0|Byte 1|Byte 2|Byte 3|Byte 4|Byte 5|      |Byte n|
    %   '------'------'------'------'------'------'------'------'
    % 
    %   Byte 0 – 1: Command size, Little Endian\n
    % 
    %   Byte 2 – 3: Message counter, Little Endian\n
    % 
    %   Byte 4:     Command type. see following defines   */
    % 
    %   #define     SYSTEM_COMMAND_REPLY          0x01    //  System command, reply required
    %   #define     SYSTEM_COMMAND_NO_REPLY       0x81    //  System command, reply not required
    %                                                     /*
    %   Byte 5:     System Command. see following defines */
    % 
    %   #define     BEGIN_DOWNLOAD                0x92    //  Begin file down load
    %   #define     CONTINUE_DOWNLOAD             0x93    //  Continue file down load
    %   #define     BEGIN_UPLOAD                  0x94    //  Begin file upload
    %   #define     CONTINUE_UPLOAD               0x95    //  Continue file upload
    %   #define     BEGIN_GETFILE                 0x96    //  Begin get bytes from a file (while writing to the file)
    %   #define     CONTINUE_GETFILE              0x97    //  Continue get byte from a file (while writing to the file)
    %   #define     CLOSE_FILEHANDLE              0x98    //  Close file handle
    %   #define     LIST_FILES                    0x99    //  List files
    %   #define     CONTINUE_LIST_FILES           0x9A    //  Continue list files
    %   #define     CREATE_DIR                    0x9B    //  Create directory
    %   #define     DELETE_FILE                   0x9C    //  Delete
    %   #define     LIST_OPEN_HANDLES             0x9D    //  List handles
    %   #define     WRITEMAILBOX                  0x9E    //  Write to mailbox
    %   #define     BLUETOOTHPIN                  0x9F    //  Transfer trusted pin code to brick
    %   #define     ENTERFWUPDATE                 0xA0    //  Restart the brick in Firmware update mode
    %   #define     SETBUNDLEID                   0xA1    //  Set Bundle ID for mode 2
    %   #define     SETBUNDLESEEDID               0xA2    //  Set bundle seed ID for mode 2
    % 
    % /*
    % 
    %   Byte 6 - n: Dependent on System Command
    % 
    % 
    % 
    %   System Command Response Bytes:
    %   ,------,------,------,------,------,------,------,------,
    %   |Byte 0|Byte 1|Byte 2|Byte 3|      |      |      |Byte n|
    %   '------'------'------'------'------'------'------'------'
    % 
    %   Byte 0 – 1: Reply size, Little Endian\n
    % 
    %   Byte 2 – 3: Message counter, Little Endian\n
    % 
    %   Byte 4:     Reply type. see following defines     */
    % 
    %   #define     SYSTEM_REPLY                  0x03    //  System command reply
    %   #define     SYSTEM_REPLY_ERROR            0x05    //  System command reply error
    % /*
    %   Byte 5:     System command this is the response to
    % 
    %   Byte 6:     Reply status
    % */
    % 
    %   // SYSTEM command return codes
    %   #define     SUCCESS                       0x00
    %   #define     UNKNOWN_HANDLE                0x01
    %   #define     HANDLE_NOT_READY              0x02
    %   #define     CORRUPT_FILE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              